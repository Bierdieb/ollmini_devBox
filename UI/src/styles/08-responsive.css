/**
 * 08-responsive.css
 *
 * PURPOSE: Responsive layouts for different screen sizes
 * DEPENDENCIES: All previous CSS files (01-07)
 * AFFECTS: Nearly ALL selectors at different breakpoints
 * LOAD ORDER: #8 - MUST load last to override all previous rules
 *
 * BREAKPOINTS:
 * - min-width: 1400px: Large desktop
 * - max-width: 1000px: Small desktop / large tablet
 * - 900px - 999px: Tablet landscape
 * - 768px - 899px: Tablet portrait
 * - max-width: 767px: Mobile
 *
 * KEY COMPONENTS:
 * - Sidebar width adjustments
 * - .input-container responsive offsets (REDEFINED 23+ TIMES!)
 * - Font size scaling
 * - Layout collapsing for mobile
 *
 * KNOWN ISSUES:
 * - .input-container rules scattered across ALL breakpoints
 * - Hard to track which styles apply at which screen size
 * - Changes here can override desktop styles from 04-sidebars.css and 05-chat.css
 * - See CSS-ARCHITECTURE.md section "Responsive Breakpoint Overlap"
 *
 * DEBUGGING TIP: Always test changes at ALL breakpoints
 *
 * See: CSS-ARCHITECTURE.md for full documentation
 */

@media (min-width: 1400px) {
    :root {
        --chat-width: 85%;
        --input-width: 75%;
    }
}

/* Desktop Medium (1200px - 1399px) */
@media (min-width: 1200px) and (max-width: 1399px) {
    :root {
        --chat-width: 90%;
        --input-width: 80%;
    }
}

/* Desktop Small / Laptop (1000px - 1199px) */
@media (min-width: 1000px) and (max-width: 1199px) {
    :root {
        --chat-width: 92%;
        --input-width: 85%;
    }

    .left-sidebar {
        width: 220px;
    }

    .sidebar-toggle {
        left: 220px;
    }

    .left-sidebar.closed ~ .sidebar-toggle {
        left: 0;
    }

    .header,
    .main-content,
    .input-container {
        margin-left: 220px;
    }

    .left-sidebar.closed ~ .header,
    .left-sidebar.closed ~ .main-content,
    .left-sidebar.closed ~ .input-container {
        margin-left: 0;
    }

    .pinned-sidebar {
        width: 280px;
    }

    .pinned-sidebar-toggle {
        right: 280px;
    }

    .pinned-sidebar-toggle.collapsed {
        right: 0;
    }

    .main-content.pinned-sidebar-visible {
        margin-right: 280px;
    }

    .input-container.pinned-sidebar-visible {
        margin-right: 280px;
    }
}

/* Tablet Landscape (900px - 999px) */
@media (min-width: 900px) and (max-width: 999px) {
    :root {
        --chat-width: 95%;
        --input-width: 90%;
        --message-font-size: 13px;
    }

    /* Auto-hide sidebars by default on tablets */
    .left-sidebar {
        width: 200px;
        transform: translateX(-100%);
    }

    .left-sidebar.open {
        transform: translateX(0);
    }

    .sidebar-toggle {
        left: 0;
    }

    .left-sidebar.open ~ .sidebar-toggle {
        left: 200px;
    }

    .header,
    .main-content,
    .input-container {
        margin-left: 0;
    }

    .pinned-sidebar {
        width: 260px;
        transform: translateX(100%);
    }

    .pinned-sidebar:not(.collapsed) {
        transform: translateX(0);
    }

    .pinned-sidebar-toggle {
        right: 0;
    }

    .pinned-sidebar-toggle:not(.collapsed) {
        right: 260px;
    }

    .main-content.pinned-sidebar-visible {
        margin-right: 260px;
    }

    .input-container.pinned-sidebar-visible {
        margin-right: 260px;
    }

    /* Reduce header complexity */
    .context-indicator {
        margin-left: 12px;
    }

    .context-bar-container,
    .rag-bar-container {
        width: 150px;
    }

    /* Token counter - make compact */
    .token-counter-left {
        min-width: 180px;
        padding: 10px;
        font-size: 11px;
    }
}

/* Tablet Portrait (768px - 899px) */
@media (min-width: 768px) and (max-width: 899px) {
    :root {
        --chat-width: 98%;
        --input-width: 95%;
        --message-font-size: 13px;
    }

    /* Force sidebars closed */
    .left-sidebar {
        transform: translateX(-100%);
    }

    .sidebar-toggle {
        left: 0;
    }

    .header,
    .main-content,
    .input-container {
        margin-left: 0;
    }

    .pinned-sidebar {
        transform: translateX(100%);
    }

    .pinned-sidebar-toggle {
        right: 0;
    }

    /* Header - Stack vertically */
    .header {
        flex-direction: column;
        align-items: flex-start;
        padding: 10px 16px;
        gap: 10px;
    }

    .header-left {
        width: 100%;
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
    }

    .context-indicator,
    .rag-indicator {
        margin-left: 0;
        width: 100%;
    }

    .context-bar-container,
    .rag-bar-container {
        width: 100%;
    }

    .header-right {
        width: 100%;
        justify-content: space-between;
    }

    /* Hide token counter on left, move info to main */
    .token-counter-left {
        display: none;
    }

    .input-container {
        flex-direction: column;
        padding: 12px;
    }

    .input-right-section {
        max-width: 100%;
    }

    /* Settings modal - more space */
    .settings-container {
        width: 95%;
        height: 90%;
    }

    .settings-sidebar {
        width: 200px;
    }

    /* Thinking blocks and tool boxes */
    .thinking-block,
    .tool-execution-box,
    .tool-result-section {
        width: 95%;
    }
}

/* Mobile Large (640px - 767px) */
@media (min-width: 640px) and (max-width: 767px) {
    :root {
        --chat-width: 100%;
        --input-width: 100%;
        --message-font-size: 14px;
        --code-font-size: 12px;
    }

    /* Hide sidebars completely */
    .left-sidebar,
    .pinned-sidebar {
        display: none;
    }

    .sidebar-toggle,
    .pinned-sidebar-toggle {
        display: none;
    }

    .header,
    .main-content,
    .input-container {
        margin-left: 0;
        margin-right: 0;
    }

    /* Header - Compact mobile */
    .header {
        padding: 8px 12px;
        flex-direction: column;
        gap: 8px;
    }

    .app-title {
        font-size: 14px;
    }

    .header-left {
        width: 100%;
        flex-direction: column;
        gap: 6px;
    }

    .context-indicator,
    .rag-indicator {
        display: none; /* Hide on mobile, show in compact format elsewhere */
    }

    .header-right {
        width: 100%;
        justify-content: center;
    }

    .model-select {
        font-size: 12px;
        padding: 5px 10px;
    }

    /* Input area - Full width, stack vertically */
    .input-container {
        padding: 10px;
        flex-direction: column;
    }

    .token-counter-left {
        display: none;
    }

    .input-right-section {
        width: 100%;
        max-width: 100%;
    }

    .input-buttons {
        flex-wrap: wrap;
        justify-content: center;
    }

    .buttons-left,
    .buttons-right {
        gap: 6px;
    }

    .canvas-toggle-button {
        padding: 6px 10px;
        font-size: 12px;
    }

    /* Chat messages - Full width */
    .message-content {
        max-width: 100%;
    }

    .content-section {
        max-width: 100%;
    }

    .thinking-block,
    .tool-execution-box,
    .tool-result-section {
        width: 100%;
    }

    /* Settings modal - Simplified */
    .settings-container {
        width: 100%;
        height: 100%;
        border-radius: 0;
    }

    .settings-sidebar {
        display: none; /* Hide sidebar, tabs at top instead */
    }

    .settings-content {
        padding: 16px;
    }

    /* Code blocks - Scrollable */
    .message-content pre {
        font-size: 11px;
        overflow-x: auto;
    }
}

/* Mobile Medium (480px - 639px) */
@media (min-width: 480px) and (max-width: 639px) {
    :root {
        --message-font-size: 13px;
        --code-font-size: 11px;
    }

    .header {
        padding: 6px 10px;
    }

    .app-title {
        font-size: 13px;
    }

    .header-right {
        gap: 6px;
    }

    .icon-button {
        padding: 6px;
    }

    .input-wrapper {
        padding: 6px 10px;
    }

    .message-input {
        font-size: 13px;
    }

    .send-button {
        padding: 8px;
    }

    .canvas-toggle-button {
        padding: 5px 8px;
        font-size: 11px;
        gap: 4px;
    }

    .canvas-toggle-button svg {
        width: 14px;
        height: 14px;
    }

    /* Chat container - Reduce padding */
    .chat-container {
        padding: 12px 8px;
    }

    .message {
        margin-bottom: 12px;
    }

    .message-content {
        padding: 10px 12px;
        font-size: 13px;
    }

    /* Settings - Full screen */
    .settings-container {
        width: 100vw;
        height: 100vh;
        max-width: 100vw;
        max-height: 100vh;
        border-radius: 0;
    }

    .settings-content {
        padding: 12px;
    }

    .settings-group {
        margin-bottom: 24px;
    }

    .settings-actions {
        padding-top: 16px;
    }
}

/* Mobile Small (below 480px) */
@media (max-width: 479px) {
    :root {
        --message-font-size: 12px;
        --code-font-size: 10px;
    }

    body {
        font-size: 12px;
    }

    /* Header - Ultra compact */
    .header {
        padding: 6px 8px;
    }

    .app-title {
        font-size: 12px;
    }

    .status-text {
        font-size: 11px;
    }

    .header-right {
        gap: 4px;
    }

    .model-select {
        font-size: 11px;
        padding: 4px 8px;
    }

    .icon-button {
        padding: 5px;
    }

    .icon-button svg {
        width: 16px;
        height: 16px;
    }

    /* Input area - Minimal padding */
    .input-container {
        padding: 8px;
    }

    .input-wrapper {
        padding: 5px 8px;
        border-radius: 8px;
    }

    .message-input {
        font-size: 12px;
        padding: 4px 0;
    }

    .send-button {
        padding: 6px;
    }

    .send-button svg {
        width: 18px;
        height: 18px;
    }

    /* Buttons - Very compact */
    .input-buttons {
        margin-top: 6px;
        gap: 6px;
    }

    .canvas-toggle-button {
        padding: 4px 6px;
        font-size: 10px;
        gap: 3px;
    }

    .canvas-toggle-button svg {
        width: 12px;
        height: 12px;
    }

    /* Chat - Minimal padding */
    .chat-container {
        padding: 8px 6px;
    }

    .message {
        margin-bottom: 10px;
    }

    .message-content {
        padding: 8px 10px;
        font-size: 12px;
        border-radius: 8px;
    }

    /* Welcome message */
    .welcome-message h2 {
        font-size: 18px;
    }

    .welcome-message p {
        font-size: 12px;
    }

    /* Settings - Full screen, no sidebar */
    .settings-overlay {
        backdrop-filter: none; /* Save performance */
    }

    .settings-container {
        width: 100vw;
        height: 100vh;
        max-width: 100vw;
        max-height: 100vh;
        border-radius: 0;
    }

    .settings-sidebar {
        display: none;
    }

    .settings-content {
        padding: 10px;
    }

    .settings-tab h2 {
        font-size: 18px;
    }

    .settings-description {
        font-size: 12px;
    }

    .settings-group label {
        font-size: 13px;
    }

    .settings-actions {
        flex-direction: column;
    }

    .settings-actions button {
        width: 100%;
    }

    /* Code blocks - Smaller font */
    .message-content pre {
        font-size: 10px;
        padding: 8px;
    }

    .message-content code {
        font-size: 10px;
        padding: 1px 4px;
    }

    /* Modal dialogs - Full width */
    .modal-content {
        width: 95%;
        padding: 16px;
    }

    .modal-content h3 {
        font-size: 16px;
    }

    .modal-content p {
        font-size: 12px;
    }

    .modal-buttons button {
        padding: 10px 16px;
        font-size: 12px;
    }

    /* Thinking blocks - Smaller */
    .thinking-block,
    .tool-execution-box,
    .tool-result-section {
        width: 100%;
        margin: 4px 0;
    }

    .thinking-header,
    .exec-header,
    .tool-result-header {
        padding: 6px 10px;
        gap: 6px;
    }

    .thinking-label,
    .exec-label,
    .result-label {
        font-size: 11px;
    }

    .thinking-content,
    .exec-details,
    .tool-result-content {
        font-size: 11px;
        padding: 8px 10px;
    }
}

/* Touch-friendly adjustments for all mobile devices */
@media (max-width: 899px) and (pointer: coarse) {
    /* Increase tap targets */
    .icon-button,
    .send-button,
    .canvas-toggle-button,
    .settings-nav-item,
    .modal-buttons button {
        min-height: 44px; /* Apple's recommended tap target */
        min-width: 44px;
    }

    /* Buttons need more spacing */
    .input-buttons {
        gap: 8px;
    }

    /* Context menu items - bigger tap targets */
    .chat-context-menu .context-menu-item {
        padding: 12px 16px;
        min-height: 44px;
    }

    /* Settings toggles - easier to tap */
    .settings-toggle {
        width: 54px;
        height: 30px;
    }

    .settings-toggle::before {
        width: 24px;
        height: 24px;
    }

    .settings-toggle:checked::before {
        transform: translateX(24px);
    }
}

/* Landscape orientation optimizations */
@media (max-height: 500px) and (orientation: landscape) {
    .header {
        padding: 4px 12px;
    }

    .input-container {
        padding: 6px 12px;
    }

    .chat-container {
        padding: 8px 12px;
    }

    /* Hide less critical UI elements */
    .context-indicator,
    .rag-indicator,
    .token-counter-left {
        display: none;
    }

    .welcome-message {
        padding-top: 20px;
    }
}

/* High DPI / Retina displays - Sharper borders */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .message-content,
    .dashboard-card,
    .settings-container,
    .modal-content {
        border-width: 0.5px;
    }
}
